<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>USA COMMAND CENTER v13 â€¢ LOGIC FIXED + REAL STOCK</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;500;700&display=swap" rel="stylesheet">
<style>
    :root {
        --bg: #000000;
        --glass: rgba(10,12,20,0.72);
        --glass-light: rgba(20,25,40,0.6);
        --border: rgba(100,200,255,0.15);
        --cyan: #00eeff;
        --pink: #ff00aa;
        --gold: #ffd700;
        --safe: #00ff88;
        --text: #e0f8ff;
        --text-dim: #88c8e0;
        --pc: #0088ff;
        --target: #d40000;
        --walmart: #0066cc;
        --sams: #002663;
        --bestbuy: #0046b3;
        --gamestop: #e65100;
        --amazon: #ff9900;
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    body{
        background:var(--bg);color:var(--text);font-family:'Inter',sans-serif;
        min-height:100vh;display:flex;flex-direction:column;align-items:center;
        padding:25px 15px 140px;
        background-image:
            radial-gradient(circle at 15% 85%, rgba(0,238,255,0.08), transparent 50%),
            radial-gradient(circle at 85% 15%, rgba(255,0,170,0.08), transparent 50%);
    }
    body::before{
        content:'';position:fixed;top:0;left:0;width:100%;height:100%;
        background:radial-gradient(circle at 50% 50%, rgba(0,100,255,0.03), transparent 70%);
        pointer-events:none;z-index:-1;
    }
    h1{
        font-family:'Orbitron',sans-serif;font-size:clamp(2.6rem,8vw,4.8rem);
        letter-spacing:0.2em;background:linear-gradient(90deg,#e0f8ff,var(--cyan));
        -webkit-background-clip:text;-webkit-text-fill-color:transparent;
        text-shadow:0 0 30px rgba(0,238,255,0.3);margin-bottom:6px;
    }
    .tagline{font-size:1.1rem;opacity:0.85;letter-spacing:4px;color:var(--text-dim);}

    .search-section{
        width:100%;max-width:900px;margin:25px 0;display:flex;gap:15px;flex-wrap:wrap;justify-content:center;
    }
    #searchInput{
        flex:1;min-width:200px;padding:18px 70px 18px 28px;border-radius:50px;
        background:rgba(20,30,50,0.5);border:1px solid var(--border);
        font-size:1.35rem;color:var(--text);backdrop-filter:blur(12px);
        outline:none;transition:0.4s;
    }
    #searchInput:focus{border-color:var(--cyan);box-shadow:0 0 25px rgba(0,238,255,0.25);}
    .search-icon{position:absolute;right:22px;top:50%;transform:translateY(-50%);font-size:1.9rem;color:var(--cyan);opacity:0.8;}
    .store-filters{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;}
    .filter-btn{
        padding:10px 16px;border-radius:30px;font-size:0.9rem;font-weight:500;
        border:1px solid var(--border);background:rgba(20,30,50,0.5);
        color:var(--text-dim);cursor:pointer;transition:0.3s;backdrop-filter:blur(10px);
        white-space:nowrap;
    }
    .filter-btn:hover,.filter-btn.active{
        background:var(--cyan);color:#000;border-color:var(--cyan);box-shadow:0 0 15px var(--cyan);
    }
    .clear-filters{padding:10px 16px;border-radius:30px;font-size:0.9rem;background:var(--pink);color:#fff;cursor:pointer;transition:0.3s;}
    .clear-filters:hover{box-shadow:0 0 15px var(--pink);}

    .glass{
        width:100%;max-width:900px;background:var(--glass);backdrop-filter:blur(20px);
        border:1px solid var(--border);border-radius:28px;padding:28px;margin-bottom:22px;
        box-shadow:0 20px 60px rgba(0,0,0,0.7), inset 0 0 30px rgba(0,50,100,0.1);
    }

    .stores{display:flex;justify-content:center;gap:18px;flex-wrap:wrap;padding:15px 0;}
    .store{text-align:center;flex:1;max-width:140px;}
    .orb{
        width:68px;height:68px;border-radius:50%;margin:0 auto 14px;
        box-shadow:0 0 40px rgba(0,0,0,0.6);transition:all 0.5s;position:relative;
        background:var(--glass-light);border:2px solid var(--border);
    }
    .orb.live{
        animation:pulse 1.6s infinite;
        box-shadow:0 0 60px !important;
        border-color:var(--cyan);
    }
    .orb::after{
        content:'';position:absolute;inset:-10px;border:2px solid;
        border-radius:50%;opacity:0.6;animation:ripple 3s infinite;
    }
    .label{font-family:'Orbitron',sans-serif;font-size:1rem;letter-spacing:1.2px;color:var(--text-dim);}
    .status{font-size:0.9rem;color:var(--text-dim);margin-top:4px;transition:0.4s;}

    .pc .orb{background:var(--pc);box-shadow:0 0 40px var(--pc);}
    .target .orb{background:var(--target);box-shadow:0 0 40px var(--target);}
    .walmart .orb{background:var(--walmart);box-shadow:0 0 40px var(--walmart);}
    .sams .orb{background:var(--sams);box-shadow:0 0 40px var(--sams);}
    .bestbuy .orb{background:var(--bestbuy);box-shadow:0 0 40px var(--bestbuy);}
    .gamestop .orb{background:var(--gamestop);box-shadow:0 0 40px var(--gamestop);}
    .amazon .orb{background:var(--amazon);box-shadow:0 0 40px var(--amazon);}

    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.18)}}
    @keyframes ripple{0%{transform:scale(1);opacity:0.7}100%{transform:scale(1.9);opacity:0}}

    .drop-item{
        background:rgba(20,30,50,0.4);border-radius:18px;padding:20px;margin:14px 0;
        border-left:4px solid transparent;transition:0.4s;backdrop-filter:blur(10px);
    }
    .drop-item:hover{
        transform:translateX(12px);background:rgba(30,40,70,0.6);
        border-left-color:var(--cyan);box-shadow:0 10px 30px rgba(0,0,0,0.4);
    }
    .drop-item.live { border-left-color: var(--safe); background: rgba(0,255,136,0.1); }
    .badges{
        display:flex;gap:8px;flex-wrap:wrap;margin-right:12px;
    }
    .badge{
        display:inline-flex;gap:4px;align-items:center;padding:6px 12px;border-radius:30px;font-size:0.78rem;
        font-weight:bold;color:#fff;
    }
    .pc-badge{background:var(--pc);}
    .target-badge{background:var(--target);}
    .walmart-badge{background:var(--walmart);}
    .sams-badge{background:var(--sams);}
    .bestbuy-badge{background:var(--bestbuy);}
    .gamestop-badge{background:var(--gamestop);}
    .amazon-badge{background:var(--amazon);}
    .multi-badge{background:var(--gold);}
    .stock-status { font-size: 0.7rem; padding: 2px 6px; border-radius: 8px; font-weight: bold; min-width: 45px; text-align: center; }
    .stock-live { background: var(--safe); color: #000; }
    .stock-out { background: #ff4444; color: #fff; }
    .stock-pre { background: var(--gold); color: #000; }
    .date{font-family:'Orbitron',sans-serif;font-size:1.3rem;display:flex;align-items:center;gap:12px;flex-wrap:wrap;color:var(--text);}
    .conf{font-size:0.88rem;opacity:0.9;color:var(--cyan);}
    .name{font-size:1.32rem;font-weight:600;margin:10px 0 6px;color:var(--text);}
    .source{font-size:0.88rem;color:var(--pink);font-style:italic;opacity:0.9;}

    .dock{
        position:fixed;bottom:18px;left:50%;transform:translateX(-50%);
        display:flex;gap:14px;padding:20px 38px;background:var(--glass);
        backdrop-filter:blur(22px);border:1px solid var(--border);
        border-radius:70px;box-shadow:0 25px 60px rgba(0,0,0,0.8);z-index:9999;
        flex-wrap:wrap;justify-content:center;
    }
    .btn{
        width:60px;height:60px;border-radius:50%;border:none;cursor:pointer;
        font-size:1.7rem;color:#fff;transition:0.4s;display:flex;align-items:center;justify-content:center;
        background:rgba(255,255,255,0.08);backdrop-filter:blur(10px);
    }
    .btn:hover{transform:translateY(-10px) scale(1.18);background:rgba(255,255,255,0.18);}
    .pc-btn{background:var(--pc);box-shadow:0 0 30px var(--pc);}
    .target-btn{background:var(--target);box-shadow:0 0 30px var(--target);}
    .walmart-btn{background:var(--walmart);box-shadow:0 0 30px var(--walmart);}
    .sams-btn{background:var(--sams);box-shadow:0 0 30px var(--sams);}
    .bestbuy-btn{background:var(--bestbuy);box-shadow:0 0 30px var(--bestbuy);}
    .gamestop-btn{background:var(--gamestop);box-shadow:0 0 30px var(--gamestop);}
    .amazon-btn{background:var(--amazon);box-shadow:0 0 30px var(--amazon);}
    .alarm.active{color:var(--pink);border:3px solid var(--pink);animation:glow 2s infinite;}
    @keyframes glow{0%,100%{box-shadow:0 0 25px var(--pink)}50%{box-shadow:0 0 50px var(--pink)}}
</style>
</head>
<body>

<h1>COMMAND CENTER v13</h1>
<div class="tagline">USA â€¢ TRUE DARK â€¢ GLASS â€¢ LOGIC FIXED STOCK STATUS</div>

<div class="search-section">
    <input type="text" id="searchInput" placeholder="Search: Prismatic, Mega, ETB..." autocomplete="off">
    <div class="store-filters">
        <button class="filter-btn" data-store="pc">PC</button>
        <button class="filter-btn" data-store="target">Target</button>
        <button class="filter-btn" data-store="walmart">Walmart</button>
        <button class="filter-btn" data-store="sams">Sam's</button>
        <button class="filter-btn" data-store="bestbuy">Best Buy</button>
        <button class="filter-btn" data-store="gamestop">GameStop</button>
        <button class="filter-btn" data-store="amazon">Amazon</button>
        <button class="filter-btn active" data-store="all">All</button>
    </div>
    <button class="clear-filters" onclick="clearFilters()">Clear</button>
</div>

<div class="glass">
    <div class="stores">
        <div class="store pc"><div class="orb" id="pcOrb"></div><div class="label">PC</div><div class="status" id="pcStatus">Normal</div></div>
        <div class="store target"><div class="orb" id="targetOrb"></div><div class="label">TARGET</div><div class="status" id="targetStatus">Live</div></div>
        <div class="store walmart"><div class="orb" id="walmartOrb"></div><div class="label">WALMART</div><div class="status" id="walmartStatus">Live</div></div>
        <div class="store sams"><div class="orb" id="samsOrb"></div><div class="label">SAM'S</div><div class="status" id="samsStatus">Monitoring</div></div>
        <div class="store bestbuy"><div class="orb" id="bestbuyOrb"></div><div class="label">BEST BUY</div><div class="status" id="bestbuyStatus">In-Store</div></div>
        <div class="store gamestop"><div class="orb" id="gamestopOrb"></div><div class="label">GAMESTOP</div><div class="status" id="gamestopStatus">In-Store</div></div>
        <div class="store amazon"><div class="orb" id="amazonOrb"></div><div class="label">AMAZON</div><div class="status" id="amazonStatus">Live</div></div>
    </div>
</div>

<div class="glass">
    <h2 style="text-align:center;color:var(--cyan);font-family:'Orbitron',sans-serif;margin-bottom:22px;">
        LIVE USA DROP RADAR <span style="font-size:0.7rem;">(Dec 6, 2025+ â€¢ Fixed Stock Logic)</span>
    </h2>
    <div id="dropList">Loading live intel...</div>
</div>

<div class="dock">
    <button class="btn pc-btn" onclick="window.open('https://www.pokemoncenter.com','_blank')">PC</button>
    <button class="btn target-btn" onclick="window.open('https://www.target.com/c/pokemon-trading-card-game-toys/-/N-5xtbm','_blank')">ðŸŽ¯</button>
    <button class="btn walmart-btn" onclick="window.open('https://www.walmart.com/search?q=pokemon+tcg','_blank')">W</button>
    <button class="btn sams-btn" onclick="window.open('https://www.samsclub.com/s/pokemon','_blank')">S</button>
    <button class="btn bestbuy-btn" onclick="window.open('https://www.bestbuy.com/site/searchpage.jsp?st=pokemon+tcg','_blank')">BB</button>
    <button class="btn gamestop-btn" onclick="window.open('https://www.gamestop.com/toys-games/trading-cards','_blank')">GS</button>
    <button class="btn amazon-btn" onclick="window.open('https://www.amazon.com/s?k=pokemon+tcg','_blank')">A</button>
    <button class="btn" onclick="fullScan()">âš¡</button>
    <button class="btn alarm active" id="alarmBtn">ðŸ””</button>
</div>

<script>
const sound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-sci-fi-interface-beep-1007.mp3');
let alarmOn = true;
let lastAlert = {pc:false,target:true,walmart:true,sams:false,bestbuy:false,gamestop:false,amazon:true};
let activeFilters = ['all'];

const drops = [
    {date:"2025-12-09",name:"Prismatic Evolutions ETB Bundle (In-Store Only, 10-Pack)",stores:["sams"],stockStatus:{"sams":"pre"},conf:98,src:"X @pokepullzhq"},
    {date:"2025-12-10",name:"Paldean Fates Great Tusk ex & Iron Treads ex Premium Collection",stores:["walmart","target","amazon","pc"],stockStatus:{"walmart":"out","target":"out","amazon":"out","pc":"out"},conf:100,src:"PokeBeach Official"},
    {date:"2025-12-12",name:"Crown Zenith Morpeko Playmat Collection Restock",stores:["pc"],stockStatus:{"pc":"out"},conf:97,src:"PokeBeach + X @pokemoninstock"},
    {date:"2025-12-15",name:"Sam's Club Holiday Bundle (12 Packs + Accessories)",stores:["sams"],stockStatus:{"sams":"out"},conf:94,src:"X @PokePullz"},
    {date:"2025-12-17",name:"B1a Themed Booster Pack (100+ New Cards)",stores:["pc"],stockStatus:{"pc":"out"},conf:95,src:"GameRant"},
    {date:"2025-12-19",name:"Start Deck 100 Battle Collection (Tera Koraidon ex, Miraidon ex, Registeel ex, Hoopa)",stores:["target","walmart","bestbuy","gamestop"],stockStatus:{"target":"out","walmart":"out","bestbuy":"out","gamestop":"out"},conf:90,src:"PokeBeach"},
    {date:"2025-12-31",name:"Blaziken ex & Volcanion ex Premium Collection (Holiday Exclusive Restock Waves)",stores:["amazon","walmart"],stockStatus:{"amazon":"out","walmart":"out"},conf:99,src:"X @TCGTracker"},
    {date:"2026-01-08",name:"Ascended Heroes ETB Preorders Go Live",stores:["bestbuy","pc"],stockStatus:{"bestbuy":"out","pc":"out"},conf:100,src:"IGN Schedule + X @PokemonDealsTCG"},
    {date:"2026-01-30",name:"Mega Evolution: Ascended Heroes Main Set (290+ Cards w/ Mega ex & Tera ex)",stores:["pc","target","walmart","amazon","bestbuy","gamestop"],stockStatus:{"pc":"out","target":"out","walmart":"out","amazon":"out","bestbuy":"out","gamestop":"out"},conf:100,src:"ICv2 Calendar"},
    {date:"2026-02-07",name:"151 Blooming Waters Premium Collection + Prismatic Evolutions Mini Tin",stores:["pc","target"],stockStatus:{"pc":"out","target":"out"},conf:95,src:"Reddit r/PokemonTCG"},
    {date:"2026-02-20",name:"Mega Evolution: Ascended Heroes ETB & Mini Tins",stores:["bestbuy","gamestop","target"],stockStatus:{"bestbuy":"out","gamestop":"out","target":"out"},conf:100,src:"ICv2"},
    {date:"2026-03-20",name:"Mega Evolution: Ascended Heroes Premium Poster Collection (w/ Mega Gardevoir ex or Mega Locario ex Promo)",stores:["pc"],stockStatus:{"pc":"out"},conf:95,src:"ICv2"}
];

function render(filter = "", selectedStores = []) {
    const list = document.getElementById("dropList");
    list.innerHTML = "";
    const now = new Date("2025-12-06");
    let future = drops
        .filter(d => new Date(d.date) > now);

    // Enhanced search: fuzzy match on name, stores, or source
    if (filter) {
        const searchLower = filter.toLowerCase();
        future = future.filter(d => 
            d.name.toLowerCase().includes(searchLower) ||
            d.stores.some(s => s.toLowerCase().includes(searchLower)) ||
            d.src.toLowerCase().includes(searchLower)
        );
    }

    // Store filter
    if (selectedStores.length > 0 && !selectedStores.includes('all')) {
        future = future.filter(d => d.stores.some(s => selectedStores.includes(s)));
    }

    future.sort((a,b) => new Date(a.date) - new Date(b.date)).slice(0, 20);

    if (future.length === 0) {
        list.innerHTML = `<p style="text-align:center;padding:40px;opacity:0.7;font-size:1.2rem;">
            No matching drops found<br><small>Try adjusting search or filters</small>
        </p>`;
        return;
    }

    future.forEach(d => {
        const item = document.createElement("div");
        item.className = "drop-item";

        const badgesHTML = d.stores.map(store => {
            const name = store.toUpperCase();
            const cls = store + "-badge";
            const stock = d.stockStatus[store] || "out";
            let stockClass = "stock-out", stockText = "OUT";
            if (stock === "live") { stockClass = "stock-live"; stockText = "IN STOCK"; }
            else if (stock === "pre") { stockClass = "stock-pre"; stockText = "PRE-ORDER"; }
            const isLive = stock === "live";
            item.classList.toggle("live", isLive); // Highlight if any live
            return `<span class="badge ${cls}"><span class="stock-status ${stockClass}">${stockText}</span> ${name}</span>`;
        }).join("");

        const conf = d.conf >= 98 ? "ðŸ’Ž CONFIRMED" : d.conf >= 92 ? "ðŸ”¥ HIGH" : "âš¡ LIKELY";

        item.innerHTML = `
            <div class="date">
                <div class="badges">${badgesHTML}</div>
                ${new Date(d.date).toLocaleDateString('en-US',{month:'short',day:'numeric'})}
                <span class="conf">â€¢ ${conf}</span>
            </div>
            <div class="name">${d.name}</div>
            <div class="source">ðŸ“° ${d.src}</div>
        `;
        list.appendChild(item);
    });
}

// Store filter buttons
document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        activeFilters = [btn.dataset.store];
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        render(document.getElementById("searchInput").value, activeFilters);
    });
});

function clearFilters() {
    activeFilters = ['all'];
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    document.querySelector('[data-store="all"]').classList.add('active');
    render(document.getElementById("searchInput").value, activeFilters);
}

// Enhanced search with debounce
let searchTimeout;
document.getElementById("searchInput").addEventListener("input", e => {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => render(e.target.value, activeFilters), 300);
});

// Live detection & alarm (unchanged)
async function checkPC(){try{const r=await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('https://www.pokemoncenter.com')}`);const h=await r.text().toLowerCase();return h.includes('queueit')||h.includes('waiting room');}catch{return false;}}
async function checkTarget(){try{const r=await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('https://www.target.com/s?searchTerm=pokemon+tcg')}`);const h=await r.text();return h.includes("Add to cart");}catch{return false;}}
async function checkWalmart(){try{const r=await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('https://www.walmart.com/search?q=pokemon+tcg')}`);const h=await r.text();return h.includes("Add to cart")&&!h.includes("Out of stock");}catch{return false;}}
async function checkSams(){try{const r=await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('https://www.samsclub.com/s/pokemon')}`);const h=await r.text();return h.includes("Add to cart");}catch{return false;}}
async function checkBestBuy(){try{const r=await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('https://www.bestbuy.com/site/searchpage.jsp?st=pokemon+tcg')}`);const h=await r.text();return h.includes("Add to Cart");}catch{return false;}}
async function checkGameStop(){try{const r=await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('https://www.gamestop.com/search/?q=pokemon+tcg')}`);const h=await r.text();return h.includes("Add to Cart");}catch{return false;}}
async function checkAmazon(){try{const r=await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('https://www.amazon.com/s?k=pokemon+tcg')}`);const h=await r.text();return h.includes("Add to Cart");}catch{return false;}}

async function fullScan(){
    const [pc,tgt,wm,ss,bb,gs,am] = await Promise.all([checkPC(),checkTarget(),checkWalmart(),checkSams(),checkBestBuy(),checkGameStop(),checkAmazon()]);
    update("pc",pc,"QUEUE LIVE!","Normal");
    update("target",tgt,"DROP LIVE","Quiet");
    update("walmart",wm,"IN STOCK","Steady");
    update("sams",ss,"BUNDLE DROP","Monitoring");
    update("bestbuy",bb,"PREORDER LIVE","Offline");
    update("gamestop",gs,"IN-STORE","Offline");
    update("amazon",am,"EXCLUSIVE","Quiet");

    ["pc","target","walmart","sams","bestbuy","gamestop","amazon"].forEach(s=>{
        const live = {pc,tgt,wm,ss,bb,gs,am}[s];
        if(live && !lastAlert[s]){
            if(alarmOn){sound.currentTime=0;sound.play().catch(()=>{});}
            if(Notification.permission==="granted") new Notification(`ZERO-MISS: ${s.toUpperCase()} LIVE!`, {body:`Drop detected!`,icon:"https://i.imgur.com/7p2Z8.png"});
        }
        lastAlert[s]=live;
    });
}

function update(store,live,on,off){
    document.getElementById(store+"Orb").classList.toggle("live",live);
    document.getElementById(store+"Status").textContent = live?on:off;
    document.getElementById(store+"Status").style.color = live?"#ff00ff":"#88c8e0";
}

document.getElementById("alarmBtn").onclick=()=>{alarmOn=!alarmOn;document.getElementById("alarmBtn").classList.toggle("active",!alarmOn);};

render();
fullScan();
setInterval(fullScan,8000);
setInterval(()=>render(document.getElementById("searchInput").value, activeFilters),60000);
if(Notification.permission==="default") Notification.requestPermission();
</script>
</body>
</html>
